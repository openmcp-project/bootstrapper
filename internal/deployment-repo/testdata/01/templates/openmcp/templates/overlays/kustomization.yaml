apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - {{ .Values.openMCPResourcesPath }}
images:
  - name: <openmcp/openmcp-operator>
    newName: {{.Values.openmcpOperator.image }}
    newTag: {{.Values.openmcpOperator.tag | default "latest"}}
    {{- if .Values.openmcpOperator.digest }}
    digest: {{ .Values.openmcpOperator.digest }}
    {{- end }}
secretGenerator:
  - name: openmcp-operator-config
    namespace: openmcp-system
    files:
      - config=config/openmcp-operator-config.yaml
patches:
{{- if .Values.userKustomizationPatches }}
{{ toYaml .Values.userKustomizationPatches | indent 2 }}
{{- end }}
  - target:
      kind: ConfigMap
      name: test-configmap
    patch: |-
      - op: replace
        path: /data/environment
        value: dev
